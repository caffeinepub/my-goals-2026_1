{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 3,
  "summary": "Goals Dashboard is a Vite + React + TypeScript single-page web app for tracking ‚Äúlifetime goals‚Äù across predefined, color-coded life-category cards. Users can add, inline-edit, delete, and mark goals complete. When a goal is completed, the app prompts the user to assign it to a month via a month-selection modal. A separate yearly summary view (‚ÄúTime-Bound targets - 2026‚Äù) projects completed+scheduled goals into a category-by-month table with UI-only checkboxes, per-month completion statistics, and donut progress charts. When a month reaches 100% completion (based on the summary checkboxes), a celebration modal opens with confetti and options to take a selfie (getUserMedia + countdown) or upload a photo; the chosen image is composited client-side into a Polaroid-style JPEG with a badge overlay and saved as a per-month ‚Äúmemory‚Äù in localStorage. These monthly memories appear as Polaroid thumbnails in the yearly summary and open into a lightbox that includes a ‚ÄúShare to Social Media‚Äù UI (system share when available, otherwise download/copy/share-link fallbacks for Instagram/Twitter/Facebook). Internet Identity authentication and ICP actor creation exist as scaffolding; this version manages goal state locally and does not use backend queries.",
  "existing_features": [
    {
      "id": "IF-1",
      "title": "React SPA bootstrap with QueryClientProvider and InternetIdentityProvider",
      "synonyms": [
        "main.tsx provider setup",
        "TanStack Query + Internet Identity context"
      ],
      "description": "Bootstraps the React app and wraps it with TanStack QueryClientProvider and an InternetIdentityProvider context; loads global Tailwind styles.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-2",
      "title": "Root app composition with global Sonner toaster",
      "synonyms": [
        "App.tsx",
        "toast notifications"
      ],
      "description": "Renders the main GoalsDashboard page and mounts a global Sonner Toaster used for lightweight user feedback (e.g., sharing actions).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-3",
      "title": "Goals dashboard with predefined category cards",
      "synonyms": [
        "GoalsDashboard cards view",
        "life categories"
      ],
      "description": "Renders predefined, color-coded category cards (title + emoji + theme colors) each containing a list of goals with checkboxes and action controls.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-4",
      "title": "Local persistence of goal cards via browser localStorage",
      "synonyms": [
        "localStorage hydration",
        "persist goals on reload"
      ],
      "description": "Hydrates cards from localStorage on initial render (fallback to defaults) and persists the cards/goals structure back to localStorage whenever it changes.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-5",
      "title": "Inline editing of goal text with keyboard shortcuts",
      "synonyms": [
        "click-to-edit",
        "in-place rename"
      ],
      "description": "Clicking a goal label enters edit mode with an auto-focused input; saves on blur/Enter (trimmed non-empty) and cancels on Escape.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-6",
      "title": "Add new goals within a category card",
      "synonyms": [
        "create goal",
        "Plus button"
      ],
      "description": "Adds a new goal to a category (with a generated id) and immediately enters inline edit mode for the new item.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-7",
      "title": "Delete goals within a category card",
      "synonyms": [
        "remove goal",
        "Trash button"
      ],
      "description": "Removes a goal from its category via a delete icon button.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-8",
      "title": "Goal completion toggle with month clearing on uncheck",
      "synonyms": [
        "mark complete/incomplete",
        "clear month assignment"
      ],
      "description": "Toggles a goal‚Äôs completed status; when unchecking a goal it resets completed=false and clears any month assignment (month: undefined).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-9",
      "title": "Completion-triggered month assignment flow",
      "synonyms": [
        "pending goal flow",
        "month picker dialog"
      ],
      "description": "When checking a goal, the UI opens a month selection modal. Confirm assigns the selected month; cancel/close reverts the pending completion.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-10",
      "title": "Month selection modal (12-month grid with confirm/cancel)",
      "synonyms": [
        "MonthSelectionModal",
        "month picker"
      ],
      "description": "Dialog prompts selection of a month using a 3√ó4 button grid. Confirm is disabled until a month is chosen; cancel closes and aborts.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-11",
      "title": "Centered auto-dismissing notification overlay",
      "synonyms": [
        "CenteredNotification",
        "toast-like overlay"
      ],
      "description": "Displays a centered message overlay (aria-live) and auto-dismisses after a configurable duration; used for month assignment confirmation and upload-save success feedback.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-12",
      "title": "Dashboard ‚Üî yearly summary view toggle (no routing)",
      "synonyms": [
        "single-page view switch",
        "See goals per month"
      ],
      "description": "Uses local state to switch between the main dashboard and the yearly summary table; summary includes a back button to return.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-13",
      "title": "Shared month constants and Month union type",
      "synonyms": [
        "MONTHS constant",
        "Month type"
      ],
      "description": "Exports a shared MONTHS array (January‚ÄìDecember) and a derived Month union type used throughout the app.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-14",
      "title": "Yearly summary table grouped by category and month",
      "synonyms": [
        "Time-Bound targets - 2026 table",
        "goals per month table"
      ],
      "description": "Projects only goals that are (completed && month assigned) into a category-by-month table with tinted month columns and per-category rows.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-15",
      "title": "UI-only completion checkboxes in yearly summary",
      "synonyms": [
        "interactive summary checkboxes",
        "non-persistent checked state"
      ],
      "description": "Provides per-goal checkboxes in the summary view whose state is stored in a local checkedState map and does not write back to goal data.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-16",
      "title": "Per-month completion statistics and progress computation",
      "synonyms": [
        "completed/incomplete percentages",
        "month stats"
      ],
      "description": "Computes total scheduled goals per month and percentage complete/incomplete based on summary checkbox state; also derives progress (0..1) and isComplete flags.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-17",
      "title": "SVG donut chart for monthly progress",
      "synonyms": [
        "MonthlyProgressDonut",
        "progress ring"
      ],
      "description": "Displays a circular progress indicator (0..1) using SVG circles with strokeDashoffset and transitions.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-18",
      "title": "Detect 100% completion transitions and open celebration modal",
      "synonyms": [
        "100% completion trigger",
        "completion transition detection"
      ],
      "description": "Detects false‚Üítrue transitions of per-month completeness and opens a monthly celebration modal for the completed month.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-19",
      "title": "Monthly completion celebration modal (confetti + preview + actions)",
      "synonyms": [
        "MonthlyCompletionCelebrationModal",
        "congratulatory dialog"
      ],
      "description": "Celebration dialog with confetti overlay, default image preview inside a Polaroid frame, and actions to take a selfie or upload a photo; performs cleanup on close.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-20",
      "title": "Selfie countdown capture flow with preview readiness and stream cleanup",
      "synonyms": [
        "countdown-to-capture flow",
        "waitForPreviewReady",
        "stop camera after snapshot"
      ],
      "description": "Starts the front camera, waits for preview readiness, runs a 5‚Üí0 countdown, captures a snapshot, stops the camera stream immediately after capture, composites the result, and saves it as the month‚Äôs memory in localStorage.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-21",
      "title": "Upload-photo flow with compositing, persistence, auto-close, and success callback",
      "synonyms": [
        "Upload Photo Instead",
        "file input processing"
      ],
      "description": "Allows users to upload an image file, converts it to a data URL, composites it with the Polaroid+overlay treatment, saves it as the month‚Äôs memory in localStorage, automatically closes the modal, and triggers a parent callback to display a centered success notification.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-22",
      "title": "Client-side celebration image compositing (Polaroid frame + overlay badge)",
      "synonyms": [
        "celebrationImageComposite",
        "canvas composite"
      ],
      "description": "Generates a JPEG data URL by drawing the selfie/photo onto a white Polaroid frame (with bottom padding) and overlaying an angled badge; includes a helper to convert a File to a data URL and exports a canonical overlay asset path constant.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-23",
      "title": "Monthly memory localStorage utilities",
      "synonyms": [
        "monthlyMemoryStorage",
        "save/get/clear/list memories"
      ],
      "description": "Provides save/get/clear/getAll helpers to persist per-month celebration images as data URLs in localStorage using month-based keys.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-24",
      "title": "Monthly memory thumbnails with Polaroid styling and lightbox",
      "synonyms": [
        "Monthly Memory row",
        "thumbnail dialog"
      ],
      "description": "Shows Polaroid-style thumbnails only when a month is 100% complete; clicking opens a Dialog lightbox with the full image.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-25",
      "title": "Share to Social Media UI inside the monthly memory lightbox",
      "synonyms": [
        "MonthlyMemoryShareActions button",
        "lightbox share button"
      ],
      "description": "Adds a visible ‚ÄúShare to Social Media‚Äù control in the top-right of the monthly memory lightbox dialog, designed to be focusable and non-disruptive to image viewing/closing.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-26",
      "title": "Social sharing actions (Instagram/Twitter/Facebook) with Web Share + fallbacks",
      "synonyms": [
        "monthlyMemoryShare utilities",
        "download/copy/share-link fallbacks"
      ],
      "description": "Implements browser-based sharing without SDKs/backends: uses Web Share API with file sharing when available; otherwise supports downloading the image, copying caption text, and opening platform-appropriate share URLs (Twitter intent, Facebook sharer) with user guidance.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-27",
      "title": "Reusable camera hooks (getUserMedia lifecycle + capture)",
      "synonyms": [
        "useCamera",
        "useCelebrationCamera"
      ],
      "description": "Implements camera support detection, start/stop and stream cleanup, optional facing-mode switching, photo capture via canvas.toBlob, and a wrapper hook that tracks preview readiness and provides a waitForPreviewReady helper with timeout.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-28",
      "title": "Runtime configuration loading for Internet Identity settings",
      "synonyms": [
        "config loader",
        "env.json + Vite env fallback"
      ],
      "description": "Loads runtime configuration (e.g., Internet Identity URL/derivation origin) from env.json with fallback to injected environment variables for deployment flexibility.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-29",
      "title": "Internet Identity authentication provider (scaffold)",
      "synonyms": [
        "II auth provider",
        "AuthClient context"
      ],
      "description": "React Context/provider for @dfinity/auth-client: initializes/restores stored identity, supports login via Internet Identity, logout/clear, and exposes status flags and errors.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-30",
      "title": "ICP backend actor creation hook with React Query caching (scaffold)",
      "synonyms": [
        "useActor",
        "actor cached by principal"
      ],
      "description": "Creates an ICP actor (anonymous or authenticated) keyed by principal in React Query; invalidates and refetches non-actor queries when actor changes.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-31",
      "title": "Placeholder queries hook indicating local-only state",
      "synonyms": [
        "useQueries placeholder",
        "no backend queries"
      ],
      "description": "Exports an empty module documenting that this version manages goal state locally and does not rely on backend goal queries.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-32",
      "title": "Backend Motoko canister stub",
      "synonyms": [
        "backend scaffold",
        "main.mo actor"
      ],
      "description": "Includes a minimal Motoko canister entrypoint defining an empty actor placeholder for future backend logic.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-33",
      "title": "Tailwind + shadcn/ui styling with custom summary/celebration/polaroid CSS",
      "synonyms": [
        "design system",
        "OKLCH theme tokens",
        "custom component styles"
      ],
      "description": "Uses Tailwind CSS with OKLCH-based theme tokens and shadcn/ui components, plus custom CSS for yearly summary table, enhanced checkbox styling, Polaroid thumbnail effects, and celebration modal camera/countdown/polaroid layouts.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "feature-in-frontend-src-components-monthlycompletioncelebrationmodal-tsx-when-a-selfie-has-been-captured-and-the-composited-photo-is-being-displayed-i-e-after-capture-completes-and-the-static-preview-is-shown-replace-the-existing-primary-action-button-labeled-take-selfie-share-with-two-buttons-labeled-save-to-memories-and-retake",
      "title": "In `frontend/src/components/MonthlyCompletionCelebrationModal.tsx`, when a selfie has been captured and the composited photo is being displayed (i.e., after capture completes and the static preview is shown), replace the existing primary action button labeled \"Take Selfie & Share\" with two buttons labeled \"Save to Memories\" and \"Retake\".",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-change-the-selfie-capture-flow-in-frontend-src-components-monthlycompletioncelebrationmodal-tsx-so-that-capturing-a-selfie-does-not-automatically-save-the-image-to-monthly-memories-instead-saving-to-localstorage-via-savemonthlymemory-month-as-month-compositeddataurl-and-invoking-onmemorysaved-month-as-month-must-happen-only-when-the-user-clicks-the-new-save-to-memories-button",
      "title": "Change the selfie capture flow in `frontend/src/components/MonthlyCompletionCelebrationModal.tsx` so that capturing a selfie does NOT automatically save the image to monthly memories; instead, saving to localStorage via `saveMonthlyMemory(month as Month, compositedDataUrl)` and invoking `onMemorySaved(month as Month)` must happen only when the user clicks the new \"Save to Memories\" button.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-the-retake-button-behavior-in-frontend-src-components-monthlycompletioncelebrationmodal-tsx-when-clicked-from-the-selfie-preview-state-return-the-modal-to-camera-mode-to-allow-capturing-a-new-selfie-clearing-the-current-preview-as-needed-and-re-running-the-existing-camera-start-countdown-flow",
      "title": "Implement the \"Retake\" button behavior in `frontend/src/components/MonthlyCompletionCelebrationModal.tsx`: when clicked from the selfie preview state, return the modal to camera mode to allow capturing a new selfie (clearing the current preview as needed and re-running the existing camera start + countdown flow).",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-when-the-user-clicks-save-to-memories-in-the-congrats-modal-show-a-centered-pop-up-notification-using-the-existing-frontend-src-components-centerednotification-tsx-component-with-the-exact-english-message-successfully-saved-and-auto-dismiss-it-after-5-seconds-5000ms",
      "title": "When the user clicks \"Save to Memories\" in the congrats modal, show a centered pop-up notification using the existing `frontend/src/components/CenteredNotification.tsx` component with the exact English message \"Successfully saved! üì∏\" and auto-dismiss it after 5 seconds (5000ms).",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "In congrats modal, after selfie is captured and displayed, replace 'Take Selfie & Share' with 'Save to Memories' and 'Retake'; show centered auto-dismissing (5s) ‚Äú¬°Successfully saved! üì∏‚Äù notification on Save.",
      "reqIds": [],
      "status": "pending"
    }
  ],
  "architectural_notes": [
    "Single-page React app; dashboard vs yearly summary switching is handled via local component state rather than routing.",
    "Core goals data (cards/goals) is kept in React state and persisted to browser localStorage (hydrate on mount, persist on change).",
    "Goal completion uses a ‚Äúpending completion‚Äù flow: checking a goal immediately toggles completion and opens a month picker; confirm assigns month; cancel/close reverts completion.",
    "Yearly summary is a derived projection of (completed && month assigned) goals using shared MONTHS constants and a Month union type.",
    "Yearly summary checkbox state is intentionally UI-only (kept in a local map) and does not mutate persisted goal completion data.",
    "100% month completion is detected by comparing computed month completeness against a previous-completion ref; a false‚Üítrue transition opens the celebration modal.",
    "Camera functionality is encapsulated in hooks (useCamera + useCelebrationCamera) to manage getUserMedia lifecycle, preview readiness gating, capture, and cleanup.",
    "Celebration images are generated client-side via Canvas compositing (Polaroid frame + angled overlay badge) and stored as JPEG data URLs.",
    "Monthly memories are stored in localStorage via a small storage utility and displayed conditionally (only when the month is 100% complete) as Polaroid thumbnails with a Dialog lightbox.",
    "Sharing monthly memories is implemented entirely client-side (Web Share API when available; otherwise download/copy/share-link guidance) without third-party SDKs or backend changes."
  ],
  "known_issues": [
    "Cards/goals are loaded from localStorage via JSON.parse without schema/version validation; malformed stored data can cause runtime/type issues.",
    "Completing a goal sets completed=true before month confirmation; reloading while the month modal is open can leave ‚Äúcompleted but unscheduled‚Äù goals (month undefined) that the summary omits.",
    "Month-cancel restores completed=false but does not clear month, which could leave inconsistent data if a month value already existed (e.g., corrupted or externally edited storage).",
    "The month-confirm notification message reads goal text from a potentially stale 'cards' closure rather than the state used in the updater, so the message can be incorrect if state changes before confirming.",
    "Yearly summary 100% completion detection effect depends only on checkedState; changes to cards/goals while on the summary view may not correctly trigger (or may mis-trigger) celebrations until a checkbox is toggled.",
    "If multiple months become 100% complete on the same interaction, the celebration modal can effectively end up celebrating whichever month is processed last in the loop.",
    "MonthlyCompletionCelebrationModal accepts month as a string and casts to Month when saving; invalid/empty values could produce incorrect localStorage keys if the modal were ever opened with a bad month value.",
    "Monthly memories are stored as base64 data URLs in localStorage; large images can exceed storage limits and fail (errors are only logged).",
    "Countdown timer ref is typed as NodeJS.Timeout in a browser component; depending on TS lib settings this can cause typing friction (browser setTimeout typically returns a number).",
    "There are two global CSS files (frontend/src/index.css and frontend/index.css) with overlapping theme variables, which can confuse maintenance and risk inconsistent styling if both are used."
  ],
  "isFixRequest": false,
  "gameProjectType": "none",
  "projectName": "Goals Dashboard",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}